<div class="ui row candidate">

{{#unless extended}}
<div class="one wide column">
    {{#if candidate.contacts.email}}
        {{#unless candidate.emailLast30}}
            {{#unless (countStages candidate.stages "1,2,3,4,5" )}}
                {{#unless candidate.clientProfile}}
                    <div class="center-vertical-wrap">
                        <div class="center-vertical">
                            <div class="ui checkbox disabled">
                                <input type="checkbox" name="email" value='{"email": "{{candidate.email}}", "id":"{{candidate.id}}", "fn":"{{candidate.firstName}}"}'>
                                <label></label>
                            </div>
                        </div>
                    </div>
                {{/unless}}
            {{/unless}}
        {{/unless}}
    {{/if}}
</div>
{{/unless}}

<div class="column two wide picture">
    <div class="center-vertical-wrap">
        <div class="center-vertical">
            <a href="/candidate/{{candidate.id}}">
                <img class="ui small circular image color" src="{{candidate.picture}}" onerror="this.src='/assets/img/client-logo.png'"/>
            </a>
        </div>
    </div>
</div>

{{#if extended}}
<div class="one wide column">
    <p><a href="{{candidate.url}}" target="_blank" class="circular ui icon button small"><i class="icon stack overflow"></i></a></p>
    <p><a href="{{candidate.url}}" target="_blank" class="circular ui icon button small"><i class="icon github"></i></a></p>
    <p><a href="{{candidate.url}}" target="_blank" class="circular ui icon button small"><i class="icon linkedin"></i></a></p>
</div>
{{/if}}

<div class="four wide column">
    <p><b>{{candidate.fullname}}</b></p>
    <p>{{candidate.headline}}</p>
    <p><b>{{candidate.current}}</b></p>
    <p>{{candidate.location}}</p>
</div>

{{#unless extended}}

<div class="two wide column candidate-details">
    <p class="{{presenceToCss candidate.cvDocumentLink}}">CV</p>
    <p class="{{presenceToCss candidate.contacts.email}}">Email</p>
    <p class="{{presenceToCss candidate.contacts.phone}}">Phone</p>
    <p class="{{presenceToCss salary}}">Salary</p>
</div>

<div class="two wide column candidate-details">
    <p class="{{presenceToCss candidate.cvDocumentLink}}">
    {{#if candidate.cvDocumentLink}}
        <i class="checkmark icon"></i>
    {{else}}
        <i class="remove icon"></i>
    {{/if}}
    </p>
    <p class="{{presenceToCss candidate.contacts.email}}">
        {{#if candidate.contacts.email}}
            <i class="checkmark icon"></i>
        {{else}}
            <i class="remove icon"></i>
        {{/if}}
    </p>
    <p class="{{presenceToCss candidate.contacts.phone}}">
        {{#if candidate.contacts.phone}}
            <i class="checkmark icon"></i>
        {{else}}
            <i class="remove icon"></i>
        {{/if}}
    </p>
</div>

{{/unless}}

{{#if extended}}
    <div class="four wide column candidate-details">

        <p class="{{presenceToCss candidate.cvDocumentLink}}">
            CV:
            {{#if candidate.cvDocumentLink}}
                <a href="{{candidate.cvDocumentLink}}" target="_blank">view</a>
            {{else}}
                N/A
            {{/if}}
        </p>
        <p class="{{presenceToCss candidate.contacts.email}}">
        Email:
            {{#if candidate.contacts.email}}
                {{candidate.contacts.email}}
            {{else}}
                N/A
            {{/if}}
        </p>
        <p class="{{presenceToCss candidate.contacts.phone}}">
            Phone:
            {{#if candidate.contacts.phone}}
                {{candidate.contacts.phone}}
            {{else}}
                N/A
            {{/if}}
        </p>
        <p class="{{presenceToCss candidate.salary}}">
            Salary:
            {{#if candidate.info.sexpected}}
                {{candidate.info.sexpected}}
            {{else}}
                N/A
            {{/if}}
        </p>
    </div>
{{/if}}


<div class="five wide column candidate-status">
    <p>
    Connected To:
    {{# if candidate.connectedTo.length }}
    {{#each candidate.connectedTo}}
            {{#if this}}
                <a href="/connected/{{encodeKeywordsHelper this}}"><b>{{initials_of_connected_users this}}</b></a>
            {{/if}}
    {{/each}}
    {{else}}
        N/A
    {{/if}}
    </p>

    <p class="stages">Status:
    {{#if candidate.stages.length}}
        {{#each candidate.stages}}
            {{generateStatus this ../clients ../stages}}<span class="comma">,</span>
        {{/each}}
    {{/if}}
    {{#if candidate.clientProfile}}
        <span class="client-employee">Client Employee</span>
    {{/if}}
    {{#unless candidate.clientProfile}}
        {{#unless candidate.stages.length}}
            N/A
        {{/unless}}
    {{/unless}}
    </p>


    <!-- @TODO get some more details here -->
    <p class="email-preview">Last Contacted:
        {{#if candidate.lastEmail.sentAt}}

        <a class="ui" href="" id="email-id-{{candidate.id}}" data-content="{{candidate.lastEmail.subject}}, {{candidate.lastEmail.senderName}}"> {{candidate.lastEmail.sentAt}}</a>

        {{else}}
            N/A
        {{/if}}

    </p>

    <p class="last-viewed-by">
    Last Viewed By: 
    {{#if candidate.viewedBy.length}}
        {{#each (lastViewedBy candidate.viewedBy) }}

            <a class="ui" href="" data-content="{{user.fullname}} ({{timestamp_formatted_long}})" id="viewed-by-{{../id}}">
            {{#unless @index}}
                {{user.initials}} ({{timestamp_formatted_short}})
            {{/unless}}
            </a>

        {{/each}}

    {{else}}
        N/A
    {{/if}}
    </p>
</div>

<!-- modals -->

{{#if candidate.viewedBy.length}}
    <div class="ui modal email viewed-by-{{candidate.id}}">
        <i class="close icon"></i>
        <div class="header">
            Viewed By
        </div>
        <div class="content">
            {{#each (lastViewedBy candidate.viewedBy) }}
                <p>{{user.fullname}} ({{timestamp_formatted_long}})</p>
            {{/each}}
        </div>
        <div class="actions"> <!-- if any actions put them here --> </div>
    </div>
{{/if}}

{{#if candidate.lastEmail.sentAt}}
    <div class="ui modal email email-id-{{id}}">
        <i class="close icon"></i>
        <div class="header">
            {{candidate.lastEmail.subject}}
        </div>
        <div class="content">
            <p class="message">{{candidate.lastEmail.message}}</p>
            <p class="sender">{{candidate.lastEmail.senderName}}</p>
            <p class="sent-at">{{candidate.lastEmail.sentAt}}</p>
        </div>
        <div class="actions"> <!-- if any actions put them here --> </div>
    </div>
{{/if}}

</div>

<div class="six column row skills black">

    {{#if candidate.listSkills.length}}
        {{#each candidate.listSkills}}
            <div class="column
            {{#if matched}}
            matched
            {{/if}}
            ">
                <div class="center-vertical-wrap">
                    <div class="center-vertical">
                        <p> {{skill}} </p>
                    </div>
                </div>
            </div>
        {{/each}}
    {{else}}
        <!-- to keep the bar always the same size -->
        <div class="column">
            <p style="opacity:0">nth</p>
        </div>
    {{/if}}

</div>


    <!-- hide it for now, I don't think it's a valuable information to display anyway -->
    <!--
    <aside class="aside aside-2">
        {{#if percentageMatch}}
            <div class="pie">{{percentageMatch}}%</div>
        {{/if}}
    </aside>
    -->


